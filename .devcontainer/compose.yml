name: data-api
services:
    devcontainer:
        build:
            context: ./images/devcontainer
            args:
                GO_VERSION: 1.24
        tty: true
        volumes:
            - ../:/workspace:cached
            - go-cache:/root/.cache
            - go-modules:/go/pkg/mod
        working_dir: /workspace
        environment:
            REDIS_URL: redis:6379
            NATS_URL: nats:4222

    nats:
        image: nats:2.11-alpine
        ports:
            - '8087:4222'
            - '8088:8222'
        command: ['-js']

    nats-nui:
        image: ghcr.io/nats-nui/nui:latest
        ports:
            - '8089:31311'
        volumes:
            - nats-nui-data:/db

    redis:
        image: redis:7-alpine

    redis-insight:
        image: redis/redisinsight:latest
        ports:
            - '8090:5540'
        environment:
            - RI_REDIS_HOST=redis
volumes:
    go-cache:
    go-modules:
    nats-nui-data:
